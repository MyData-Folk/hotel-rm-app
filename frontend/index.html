<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord Hôtelier - Simulateur Avancé</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="gradient-header text-white shadow-lg">
        <div class="container mx-auto px-4 py-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold">Tableau de Bord Hôtelier</h1>
            <p id="header-subtitle" class="mt-2 text-lg text-blue-100">Simulez une réservation ou vérifiez vos disponibilités</p>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-7xl">
        <div class="card p-6 md:p-8 mb-8">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                <div class="flex-grow w-full md:w-auto">
                    <label for="hotelId" class="block text-sm font-medium text-gray-700 mb-2">Charger les données pour l'hôtel :</label>
                    <div class="flex">
                        <select id="hotelId" class="form-input rounded-r-none">
                            <option value="">-- Sélectionner --</option>
                        </select>
                        <button id="refreshDataBtn" class="btn btn-secondary rounded-l-none" title="Charger/Rafraîchir les données">Rafraîchir</button>
                    </div>
                </div>
                <div class="flex items-center gap-4 mt-4 md:mt-0">
                    <a href="https://admin-folkestone.e-hotelmanager.com" class="btn btn-secondary">Paramètres</a>
                </div>
            </div>
            <p id="statusMessage" class="text-sm text-gray-600 mt-4">Veuillez sélectionner un hôtel et cliquer sur rafraîchir.</p>
        </div>

        <div id="main-tools" class="card p-0 opacity-50 pointer-events-none transition-all duration-300">
            <div class="flex border-b border-gray-200">
                <button class="tab-link tab-active" data-tab="simulator">Simulateur de Réservation</button>
                <button class="tab-link" data-tab="availability">Vérificateur de Disponibilité</button>
            </div>
            
            <div id="tab-content-simulator" class="p-6 md:p-8">
                <form id="simulationForm" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 items-end">
                    <div>
                        <label for="simPartner" class="block text-sm font-medium mb-1">Partenaire</label>
                        <select id="simPartner" class="form-input">
                            <option value="">En Direct (0%)</option>
                        </select>
                    </div>
                    <div>
                        <label for="simRoomType" class="block text-sm font-medium mb-1">Type de chambre</label>
                        <select id="simRoomType" class="form-input">
                            <option value="">-- Sélectionner --</option>
                        </select>
                    </div>
                    <div>
                        <label for="simRatePlan" class="block text-sm font-medium mb-1">Plan tarifaire</label>
                        <select id="simRatePlan" class="form-input">
                            <option value="">-- Sélectionner --</option>
                        </select>
                    </div>
                    <div>
                        <label for="simStartDate" class="block text-sm font-medium mb-1">Date d'arrivée</label>
                        <input type="date" id="simStartDate" class="form-input">
                    </div>
                    <div>
                        <label for="simEndDate" class="block text-sm font-medium mb-1">Date de départ</label>
                        <input type="date" id="simEndDate" class="form-input">
                    </div>
                    <div class="flex items-end">
                        <button type="submit" class="btn btn-gradient-primary w-full">Simuler la Réservation</button>
                    </div>
                </form>

                <div class="flex flex-col md:flex-row items-start md:items-center gap-4 mt-6 p-4 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-2">
                        <input type="checkbox" id="applyCommission" checked class="rounded border-gray-300">
                        <label for="applyCommission" class="text-sm font-medium" id="commissionLabel">Appliquer commission (0%)</label>
                    </div>
                    <div class="flex items-center gap-2">
                        <input type="checkbox" id="applyPartnerDiscount" checked class="rounded border-gray-300">
                        <label for="applyPartnerDiscount" class="text-sm font-medium" id="partnerDiscountLabel">Appliquer remise partenaire (0%)</label>
                    </div>
                    <div class="flex items-center gap-2">
                        <label for="promoDiscount" class="text-sm font-medium">Remise promotionnelle (%):</label>
                        <input type="number" id="promoDiscount" min="0" max="100" value="0" class="w-20 px-2 py-1 border border-gray-300 rounded">
                    </div>
                </div>
            </div>

            <div id="tab-content-availability" class="p-6 md:p-8 hidden">
                <form id="availabilityForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Types de chambres</label>
                        <div id="availRoomTypesContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-4 border rounded-lg bg-gray-50">
                            <!-- Les cases à cocher seront générées ici -->
                        </div>
                        <div>
                          <button type="button" id="selectAllRoomsBtn" class="text-xs text-blue-600">Tout sélectionner</button> /
                          <button type="button" id="deselectAllRoomsBtn" class="text-xs text-blue-600">Tout désélectionner</button>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-end">
                         <div>
                             <label for="availStartDate" class="block text-sm font-medium mb-1">Date de début</label>
                             <input type="date" id="availStartDate" class="form-input">
                         </div>
                         <div>
                             <label for="availEndDate" class="block text-sm font-medium mb-1">Date de fin</label>
                             <input type="date" id="availEndDate" class="form-input">
                         </div>
                         <div class="flex items-end">
                             <button type="submit" class="btn btn-gradient-primary w-full">Vérifier Disponibilités</button>
                         </div>
                    </div>
                </form>
                <div id="availabilityResults" class="mt-6 hidden">
                    <div class="flex justify-between items-center border-b pb-4 mb-4">
                        <h2 class="text-xl font-bold text-gray-800">Tableau des Disponibilités</h2>
                    </div>
                    <div id="availabilityTableContainer" class="overflow-x-auto"></div>
                </div>
            </div>
        </div>

        <div id="resultsContainer" class="card mt-8 hidden animate-fade-in">
            <div class="border-b pb-4 mb-6">
                <h2 class="text-xl font-bold text-gray-800">Simulation : <span id="simRoomName">-</span></h2>
                <p class="text-sm text-gray-600 mt-1" id="simSourceInfo">Source: -</p>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-3 text-left font-semibold text-gray-700">Date</th>
                            <th class="px-4 py-3 text-right font-semibold text-gray-700">Prix Brut (€)</th>
                            <th class="px-4 py-3 text-right font-semibold text-gray-700">Prix Net (€)</th>
                            <th class="px-4 py-3 text-right font-semibold text-gray-700">Stock</th>
                            <th class="px-4 py-3 text-right font-semibold text-gray-700">Disponibilité</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody" class="divide-y divide-gray-200"></tbody>
                </table>
            </div>
            <div class="mt-6 p-4 bg-gray-50 rounded-lg grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-semibold text-gray-800 mb-3">Détail des calculs</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Sous-Total Brut:</span>
                            <span id="subtotalBrut" class="font-semibold">- €</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Remises & Promos:</span>
                            <span id="totalDiscount" class="font-semibold text-green-600">- €</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Total Commission:</span>
                            <span id="totalCommission" class="font-semibold text-red-600">- €</span>
                        </div>
                    </div>
                </div>
                <div class="border-l pl-6">
                    <h3 class="font-semibold text-gray-800 mb-3">Total Net Final</h3>
                    <div id="totalNetFinal" class="text-2xl font-bold text-indigo-700">- €</div>
                </div>
            </div>
            <div class="mt-6 flex justify-end gap-4">
                <button id="newSimulationBtn" class="btn btn-secondary">Nouvelle Simulation</button>
                <button id="exportBtn" class="btn btn-gradient-primary">Exporter en Excel</button>
            </div>
        </div>
    </main>
  
    <div id="spinner-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="spinner"></div>
    </div>
    <div id="toast" class="toast"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const API_URL = 'https://api-folkestone.e-hotelmanager.com';
    let hotelData = {}, hotelConfig = {}, currentSimulationData = null;

    const DOMElements = {
        hotelIdSelect: document.getElementById('hotelId'),
        refreshDataBtn: document.getElementById('refreshDataBtn'),
        statusMessage: document.getElementById('statusMessage'),
        mainTools: document.getElementById('main-tools'),
        simPartnerSelect: document.getElementById('simPartner'),
        simRoomTypeSelect: document.getElementById('simRoomType'),
        simRatePlanSelect: document.getElementById('simRatePlan'),
        simulationForm: document.getElementById('simulationForm'),
        simStartDate: document.getElementById('simStartDate'),
        simEndDate: document.getElementById('simEndDate'),
        resultsContainer: document.getElementById('resultsContainer'),
        resultsTableBody: document.getElementById('resultsTableBody'),
        spinner: document.getElementById('spinner-overlay'),
        toast: document.getElementById('toast'),
        applyCommission: document.getElementById('applyCommission'),
        applyPartnerDiscount: document.getElementById('applyPartnerDiscount'),
        promoDiscount: document.getElementById('promoDiscount'),
        exportBtn: document.getElementById('exportBtn'),
        newSimulationBtn: document.getElementById('newSimulationBtn'),
        availabilityForm: document.getElementById('availabilityForm'),
        availRoomTypesContainer: document.getElementById('availRoomTypesContainer'),
        availStartDate: document.getElementById('availStartDate'),
        availEndDate: document.getElementById('availEndDate'),
        availabilityResults: document.getElementById('availabilityResults'),
        availabilityTableContainer: document.getElementById('availabilityTableContainer'),
        selectAllRoomsBtn: document.getElementById('selectAllRoomsBtn'),
        deselectAllRoomsBtn: document.getElementById('deselectAllRoomsBtn'),
        commissionLabel: document.getElementById('commissionLabel'),
        partnerDiscountLabel: document.getElementById('partnerDiscountLabel')
    };

    // CORRECTION : Vérification que les éléments existent
    console.log('DOM Elements loaded:', DOMElements);

    const showSpinner = () => {
        if (DOMElements.spinner) DOMElements.spinner.classList.remove('hidden');
    };
    
    const hideSpinner = () => {
        if (DOMElements.spinner) DOMElements.spinner.classList.add('hidden');
    };
    
    const showToast = (message, isError = false) => {
        if (!DOMElements.toast) return;
        DOMElements.toast.textContent = message;
        DOMElements.toast.className = `toast show ${isError ? 'bg-red-500' : 'bg-green-600'}`;
        setTimeout(() => {
            if (DOMElements.toast) DOMElements.toast.classList.remove('show');
        }, 4000);
    };

    const formatCurrency = (val) => {
        if (val === null || val === undefined) return '–';
        return `${val.toFixed(2).replace('.', ',')} €`;
    };

    const fetchHotels = async () => {
        try {
            const res = await fetch(`${API_URL}/hotels`);
            if (!res.ok) throw new Error('Impossible de charger les hôtels.');
            const hotels = await res.json();
            
            if (DOMElements.hotelIdSelect) {
                DOMElements.hotelIdSelect.innerHTML = '<option value="">-- Sélectionner --</option>';
                hotels.forEach(id => {
                    DOMElements.hotelIdSelect.innerHTML += `<option value="${id}">${id}</option>`;
                });
            }
        } catch(error) {
            console.error('Erreur chargement hôtels:', error);
            showToast(error.message, true);
        }
    };

    const loadData = async () => {
        const hotelId = DOMElements.hotelIdSelect?.value;
        if (!hotelId) return showToast("Veuillez sélectionner un hôtel.", true);
        
        showSpinner();
        if (DOMElements.statusMessage) {
            DOMElements.statusMessage.textContent = 'Chargement des données...';
        }
        if (DOMElements.mainTools) {
            DOMElements.mainTools.classList.add('opacity-50', 'pointer-events-none');
        }
        
        try {
            const [dataRes, configRes] = await Promise.all([
                fetch(`${API_URL}/data?hotel_id=${encodeURIComponent(hotelId)}`),
                fetch(`${API_URL}/config?hotel_id=${encodeURIComponent(hotelId)}`)
            ]);
            
            if (!dataRes.ok) throw new Error('Données introuvables');
            if (!configRes.ok) throw new Error('Configuration introuvable');
            
            const data = await dataRes.json();
            hotelData = data.rooms || {};
            hotelConfig = await configRes.json();
            
            console.log('Données chargées:', { hotelData, hotelConfig });
            
            populateSelectors();
            
            if (DOMElements.statusMessage) {
                DOMElements.statusMessage.textContent = `Données pour '${hotelId}' chargées avec succès.`;
            }
            if (DOMElements.mainTools) {
                DOMElements.mainTools.classList.remove('opacity-50', 'pointer-events-none');
            }
            showToast(`Données pour ${hotelId} chargées avec succès`);
            
        } catch (error) {
            console.error('Erreur chargement données:', error);
            if (DOMElements.statusMessage) {
                DOMElements.statusMessage.textContent = `Erreur: ${error.message}`;
            }
            showToast(error.message, true);
        } finally {
            hideSpinner();
        }
    };

    const populateSelectors = () => {
        console.log('Populating selectors with data:', { hotelData, hotelConfig });
        
        // CORRECTION : Vérification que les sélecteurs existent
        if (!DOMElements.simPartnerSelect || !DOMElements.simRoomTypeSelect || !DOMElements.availRoomTypesContainer) {
            console.error('Sélecteurs manquants');
            return;
        }

        // Partenaires
        DOMElements.simPartnerSelect.innerHTML = '<option value="">En Direct (0%)</option>';
        
        if (hotelConfig.partners) {
            Object.keys(hotelConfig.partners).sort().forEach(name => {
                const partner = hotelConfig.partners[name];
                DOMElements.simPartnerSelect.innerHTML += `<option value="${name}">${name} (${partner.commission}%)</option>`;
            });
        }

        // Types de chambres
        const roomOrder = hotelConfig.displayOrder?.rooms || Object.keys(hotelData);
        DOMElements.simRoomTypeSelect.innerHTML = '<option value="">-- Sélectionner --</option>';
        DOMElements.availRoomTypesContainer.innerHTML = '';
        
        roomOrder.filter(room => hotelData[room]).forEach(room => {
            DOMElements.simRoomTypeSelect.innerHTML += `<option value="${room}">${room}</option>`;
            DOMElements.availRoomTypesContainer.innerHTML += `
                <div class="flex items-center">
                    <input type="checkbox" id="room-${room}" value="${room}" checked class="room-checkbox rounded border-gray-300">
                    <label for="room-${room}" class="ml-2 text-sm">${room}</label>
                </div>`;
        });

        updateRatePlans();
    };
    
    const updateRatePlans = async () => {
        // CORRECTION : Vérification que tous les éléments existent
        if (!DOMElements.simRoomTypeSelect || !DOMElements.simPartnerSelect || !DOMElements.hotelIdSelect || 
            !DOMElements.simRatePlanSelect || !DOMElements.commissionLabel || !DOMElements.partnerDiscountLabel) {
            console.error('Éléments manquants pour updateRatePlans');
            return;
        }

        const room = DOMElements.simRoomTypeSelect.value;
        const partner = DOMElements.simPartnerSelect.value;
        const hotelId = DOMElements.hotelIdSelect.value;
        
        if (!room || !hotelId) {
            DOMElements.simRatePlanSelect.innerHTML = '<option value="">-- Sélectionner --</option>';
            return;
        }
        
        showSpinner();
        try {
            const params = new URLSearchParams({
                hotel_id: hotelId,
                room_type: room,
                partner_name: partner || ''
            });
            
            const res = await fetch(`${API_URL}/plans/partner?${params}`);
            if (!res.ok) throw new Error('Erreur chargement plans');
            
            const data = await res.json();
            console.log('Plans chargés:', data);
            
            DOMElements.simRatePlanSelect.innerHTML = '<option value="">-- Sélectionner --</option>';
            
            if (data.plans && data.plans.length > 0) {
                data.plans.forEach(plan => {
                    DOMElements.simRatePlanSelect.innerHTML += `<option value="${plan}">${plan}</option>`;
                });
            } else {
                DOMElements.simRatePlanSelect.innerHTML = '<option value="">Aucun plan disponible</option>';
            }
            
            // CORRECTION : Mise à jour sécurisée des labels
            const partnerInfo = hotelConfig.partners?.[partner];
            if (partnerInfo) {
                DOMElements.commissionLabel.textContent = `Appliquer commission (${partnerInfo.commission || 0}%)`;
                DOMElements.partnerDiscountLabel.textContent = `Appliquer remise partenaire (${partnerInfo.defaultDiscount?.percentage || 0}%)`;
            } else {
                DOMElements.commissionLabel.textContent = `Appliquer commission (0%)`;
                DOMElements.partnerDiscountLabel.textContent = `Appliquer remise partenaire (0%)`;
            }
            
        } catch (error) {
            console.error('Erreur chargement plans:', error);
            DOMElements.simRatePlanSelect.innerHTML = '<option value="">Erreur chargement</option>';
            showToast('Erreur chargement des plans', true);
        } finally {
            hideSpinner();
        }
    };

    const handleSimulation = async (e) => {
        e.preventDefault();
        const payload = {
            hotel_id: DOMElements.hotelIdSelect.value,
            room: DOMElements.simRoomTypeSelect.value,
            plan: DOMElements.simRatePlanSelect.value,
            start: DOMElements.simStartDate.value,
            end: DOMElements.simEndDate.value,
            partner_name: DOMElements.simPartnerSelect.value || null,
            apply_commission: DOMElements.applyCommission.checked,
            apply_partner_discount: DOMElements.applyPartnerDiscount.checked,
            promo_discount: parseFloat(DOMElements.promoDiscount.value) || 0
        };
        
        if (!payload.start || !payload.end) return showToast("Les dates sont requises.", true);
        if (!payload.room) return showToast("Le type de chambre est requis.", true);
        if (!payload.plan) return showToast("Le plan tarifaire est requis.", true);
        
        showSpinner();
        try {
            const res = await fetch(`${API_URL}/simulate`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            
            const result = await res.json();
            if (!res.ok) throw new Error(result.detail || 'Erreur de simulation');
            
            displayResults(result);
            showToast('Simulation terminée avec succès');
            
        } catch (error) {
            console.error('Erreur simulation:', error);
            showToast(error.message, true);
        } finally {
            hideSpinner();
        }
    };

    const displayResults = (data) => {
        currentSimulationData = data;
        DOMElements.resultsContainer.classList.remove('hidden');
        
        document.getElementById('simRoomName').textContent = data.simulation_info.room;
        document.getElementById('simSourceInfo').textContent = `Source: ${data.simulation_info.source}`;
        
        DOMElements.resultsTableBody.innerHTML = data.results.map(day => {
            const stockColor = (day.stock ?? 0) > 2 ? 'text-green-600' : (day.stock ?? 0) > 0 ? 'text-orange-500' : 'text-red-500';
            return `<tr>
                <td class="px-4 py-3">${day.date_display}</td>
                <td class="px-4 py-3 text-right">${formatCurrency(day.gross_price)}</td>
                <td class="px-4 py-3 text-right font-semibold text-indigo-700">${formatCurrency(day.net_price)}</td>
                <td class="px-4 py-3 text-right font-medium ${stockColor}">${day.stock ?? 'N/A'}</td>
                <td class="px-4 py-3 text-right">${day.availability}</td>
            </tr>`;
        }).join('');
        
        const { summary } = data;
        document.getElementById('subtotalBrut').textContent = formatCurrency(summary.subtotal_brut);
        document.getElementById('totalDiscount').textContent = `- ${formatCurrency(summary.total_discount)}`;
        document.getElementById('totalCommission').textContent = `- ${formatCurrency(summary.total_commission)}`;
        document.getElementById('totalNetFinal').textContent = formatCurrency(summary.total_net);
    };

    const handleAvailability = async (e) => {
        e.preventDefault();
        const selectedRooms = Array.from(document.querySelectorAll('.room-checkbox:checked')).map(cb => cb.value);
        if (selectedRooms.length === 0) return showToast("Veuillez sélectionner au moins une chambre.", true);
        
        const payload = {
            hotel_id: DOMElements.hotelIdSelect.value,
            start_date: DOMElements.availStartDate.value,
            end_date: DOMElements.availEndDate.value,
            room_types: selectedRooms
        };
        
        if (!payload.start_date || !payload.end_date) return showToast("Les dates sont requises.", true);
        
        showSpinner();
        try {
            const res = await fetch(`${API_URL}/availability`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            
            const result = await res.json();
            if (!res.ok) throw new Error(result.detail || 'Erreur disponibilités');
            
            displayAvailabilityResults(result);
            showToast('Disponibilités chargées avec succès');
            
        } catch (error) {
            console.error('Erreur disponibilités:', error);
            showToast(error.message, true);
        } finally {
            hideSpinner();
        }
    };

    const displayAvailabilityResults = (data) => {
        DOMElements.availabilityResults.classList.remove('hidden');
        
        let tableHTML = `
            <table class="w-full text-sm">
                <thead>
                    <tr>
                        <th class="px-2 py-3 text-left font-semibold text-gray-700 sticky left-0 bg-gray-50 z-10">Type de chambre</th>
        `;
        
        data.period.dates.forEach(date => {
            tableHTML += `<th class="px-2 py-2 text-center font-semibold text-gray-700">${data.period.date_display[date]}</th>`;
        });
        
        tableHTML += '</tr></thead><tbody class="divide-y divide-gray-200">';
        
        Object.entries(data.availability).forEach(([roomName, dates]) => {
            tableHTML += '<tr class="hover:bg-gray-50">';
            tableHTML += `<td class="px-2 py-3 font-medium sticky left-0 bg-white z-10">${roomName}</td>`;
            
            data.period.dates.forEach(date => {
                const stock = dates[date];
                let bgColor = 'bg-red-100 text-red-800';
                if (stock > 0) bgColor = 'bg-orange-100 text-orange-800';
                if (stock > 2) bgColor = 'bg-green-100 text-green-800';
                tableHTML += `<td class="text-center font-semibold ${bgColor}">${stock}</td>`;
            });
            
            tableHTML += '</tr>';
        });
        
        tableHTML += '</tbody></table>';
        DOMElements.availabilityTableContainer.innerHTML = tableHTML;
    };
    
    // Event listeners
    DOMElements.refreshDataBtn.addEventListener('click', loadData);
    DOMElements.simRoomTypeSelect.addEventListener('change', updateRatePlans);
    DOMElements.simPartnerSelect.addEventListener('change', updateRatePlans);
    DOMElements.simulationForm.addEventListener('submit', handleSimulation);
    DOMElements.availabilityForm.addEventListener('submit', handleAvailability);
    DOMElements.newSimulationBtn.addEventListener('click', () => DOMElements.resultsContainer.classList.add('hidden'));
    
    DOMElements.selectAllRoomsBtn.addEventListener('click', () => {
        document.querySelectorAll('.room-checkbox').forEach(cb => cb.checked = true);
    });
    
    DOMElements.deselectAllRoomsBtn.addEventListener('click', () => {
        document.querySelectorAll('.room-checkbox').forEach(cb => cb.checked = false);
    });
    
    document.querySelectorAll('.tab-link').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelectorAll('.tab-link').forEach(btn => btn.classList.remove('tab-active'));
            button.classList.add('tab-active');
            document.querySelectorAll('[id^="tab-content-"]').forEach(content => content.classList.add('hidden'));
            document.getElementById(`tab-content-${button.dataset.tab}`).classList.remove('hidden');
        });
    });

    // Initialisation des dates
    const today = new Date();
    const nextWeek = new Date(new Date().setDate(today.getDate() + 7));
    [DOMElements.simStartDate, DOMElements.availStartDate].forEach(el => el.value = today.toISOString().split('T')[0]);
    [DOMElements.simEndDate, DOMElements.availEndDate].forEach(el => el.value = nextWeek.toISOString().split('T')[0]);
    
    fetchHotels();
});
</script>
</body>
</html>